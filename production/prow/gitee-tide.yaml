apiVersion: v1
kind: ConfigMap
metadata:
  namespace: prow
  name: gitee-tide
data:
  config.yaml: |
    prowjob_namespace: prow
    pod_namespace: prow-pods

    plank:
      job_url_template: '{{if .Spec.Refs}}{{if eq .Spec.Refs.Org "kubernetes-security"}}http://console.cloud.google.com/storage/browser/kubernetes-security-prow/{{else}}http://dev-prow.mindspore.cn/view/gcs/prow-artifacts/{{end}}{{else}}http://dev-prow.mindspore.cn/view/gcs/prow-artifacts/{{end}}{{if eq .Spec.Type "presubmit"}}pr-logs/pull{{else if eq .Spec.Type "batch"}}pr-logs/pull{{else}}logs{{end}}{{if eq .Spec.Type "presubmit"}}{{if .Spec.Refs}}{{if eq .Spec.Refs.Org "kubernetes"}}{{if ne .Spec.Refs.Repo "kubernetes"}}/{{.Spec.Refs.Repo}}{{end}}{{else}}/{{.Spec.Refs.Org}}_{{.Spec.Refs.Repo}}{{end}}{{end}}/{{with index .Spec.Refs.Pulls 0}}{{.Number}}{{end}}{{else if eq .Spec.Type "batch"}}/batch{{end}}/{{.Spec.Job}}/{{.Status.BuildID}}/'
      job_url_prefix_config:
        '*': http://119.8.42.216/view/s3/
      pod_pending_timeout: 15m
      pod_unscheduled_timeout: 1m
      default_decoration_configs:
        '*':
          utility_images: # using the tag we identified above
            clonerefs: "zengchen1024/clonerefs:v20200228-31c76new2"
            initupload: "zengchen1024/initupload:v20200228-31c76new2"
            sidecar: "zengchen1024/sidecar:v20200228-31c76new2"
            entrypoint: "gcr.io/k8s-prow/entrypoint:v20200406-5c0e225cf"
          gcs_configuration:
            bucket: s3://mindspore-prow-artifacts # the bucket we just made
            path_strategy: explicit
          s3_credentials_secret: s3-credentials
